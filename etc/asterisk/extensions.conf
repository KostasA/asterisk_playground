[incoming]
exten = 991123123,1,Goto(from-internal,100,1)
exten = 991123124,1,Goto(from-internal,200,1)

exten = 991123300,1,Goto(from-internal,300,1)



exten = 3026510,1,GoSub(timecheck,s,1)
same = n,NoOp(timecheck is OK)
same = n,Goto(from-internal,200,1)

[timecheck]
exten = s,1,GotoIfTime(8:00-17:00,mon-thu,*,*?ok,1)
same = n,GotoIfTime(8:00-12:00,fri-fri,*,*?ok,1)
same = n,NoOp(timecheck is NOT OK)
same = n,Playback(tt-monkeys)
same = n,Hangup

exten = ok,1,Return


[ivr-1]
exten = s,1,NoOp(IVR MENU)
same = n,Answer
same = n,Playback(ivr_intro_ak89com)
same = n,WaitExten(5)

exten = 1,1,NoOp(Pressed 1)
exten = n,Queue(dummy_queue_1)

exten = 2,1,NoOp(Pressed 2)
same = n,Queue(dummy_queue_2)

exten = i,1,NoOp(Invalid)
same = n,Playback(ivr_wrong_key)
same = n,Goto(s,1)

exten = t,1,NoOp(timeout)
same = n,Queue(dummy_queue_1)

[from-internal]
exten = 800,1,Goto(ivr-1,s,1)

exten = *666,1,NoOp(playback)
same = n,Answer
same = n,Playback(asterisk_tutorial)
same = n,Hangup

exten = *200,1,Answer
same = n,WaitExten
same = n,Hangup


exten = 100,1,NoOp(Call for 6002)
same = n,Dial(PJSIP/6002,5) ;5 is a timeout to the dial application, dial 6002 but try it only for 5 seconds
same = n,GotoIf($[ "${DIALSTATUS}" = "BUSY" ]?100-busy,1)
same = n,VoiceMail(${EXTEN},u)
same = n,Hangup

exten = 100-busy,1,VoiceMail(${EXTEN:0:3},b)
same = n,Hangup

exten = 200,1,NoOp(Call for 6001)
same = n,Dial(PJSIP/6001,10)
same = n,VoiceMail(${EXTEN})
same = n,Hangup

exten = *201,1,NoOp(Add 6001 to support)
same = n,Answer()
same = n,AddQueueMember(support,PJSIP/6001)
same = n,Playback(beep)
same = n,Hangup

exten = *202,1,NoOp(Remove 6001 from support)
same = n,Answer()
same = n,RemoveQueueMember(support,PJSIP/6001)
same = n,Playback(beeperr)
same = n,Hangup

exten = *300,1,NoOp(6001 login/logout)
same = n,GotoIf(${REGEX("PJSIP/6001",${DB(Queue/PersistentMembers/support)})}?*300-logout,1:*300-login,1)

exten = *300-logout,1,NoOp(6001 exists, logout)
same = n,RemoveQueueMember(support,PJSIP/6001)
same = n,Playback(beep)
same = n,Hangup

exten = *300-login,1,NoOp(6001 doesn't exist, login)
same = n,AddQueueMember(support,PJSIP/6001)
same = n,Playback(beep)
same = n,Hangup

;exten = *300,1,NoOp(database playground)
;same = n,GotoIf(${DB_EXISTS(ak89com/6001)}?*300-ok,1)
;same = n,Hangup

exten = *300-ok,1,NoOp(6001 exists)
same = n,Answer()
same = n,Playback(beep)
same = n,Hangup

exten = 300,1,NoOp(Support Team)
same = n,Set(CHANNEL(musicclass)=support)
same = n,Answer()
same = n,Queue(support,,,,60)
same = n,Hangup

exten = *100,1,VoiceMailMain(100)
same = n,Hangup



exten = _0X.,1,NoOp(${EXTEN:1:4}) ;The fisrt number is the offset, the second is the length
same = n,Goto(outgoing,${EXTEN:1},1) ;it's a good idea to throw away the zerp because we don't need it

[outgoing]
exten = _X.,1,Dial(PJSIP/outside)
